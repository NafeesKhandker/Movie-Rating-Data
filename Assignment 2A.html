<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Khandker Qaiduzzaman">

<title>Assignment 2A</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Assignment 2A_files/libs/clipboard/clipboard.min.js"></script>
<script src="Assignment 2A_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="Assignment 2A_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="Assignment 2A_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="Assignment 2A_files/libs/quarto-html/popper.min.js"></script>
<script src="Assignment 2A_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Assignment 2A_files/libs/quarto-html/anchor.min.js"></script>
<link href="Assignment 2A_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Assignment 2A_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Assignment 2A_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Assignment 2A_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Assignment 2A_files/libs/bootstrap/bootstrap-9e3ffae467580fdb927a41352e75a2e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Assignment 2A</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Khandker Qaiduzzaman </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="objective" class="level1">
<h1>Objective</h1>
<p>Collect simple movie-rating data, store it in a SQL database, and analyze it in R.</p>
</section>
<section id="approach" class="level1">
<h1>Approach</h1>
<section id="data-collection-strategy" class="level3">
<h3 class="anchored" data-anchor-id="data-collection-strategy">Data Collection Strategy</h3>
<p>To collect simple movie-rating data, I have created a google form to collect the survey response and sent the link to several respondent. The respondent rated 6 recent popular movies on a scale of 1 to 5. Additionally, they provided some demographic information. The survey link is as follows: <a href="https://forms.gle/qkDSQNKwsKNd7AMfA">Movie Rating Survey</a></p>
</section>
<section id="survey-question" class="level3">
<h3 class="anchored" data-anchor-id="survey-question">Survey Question</h3>
<p>The following are the survey questions that were asked in the Google form:</p>
<ul>
<li><p>Email</p></li>
<li><p>Name</p></li>
<li><p>Please enter your age</p></li>
<li><p>Please enter your gender</p></li>
<li><p>Rate Superman (2025) on a scale of 1 to 5. Enter “NA” if you haven’t watched this movie</p></li>
<li><p>Rate F1: The Movie (2025) on a scale of 1 to 5. Enter “NA” if you haven’t watched this movie</p></li>
<li><p>Rate Mission: Impossible – The Final Reckoning (2025) on a scale of 1 to 5. Enter “NA” if you haven’t watched this movie</p></li>
<li><p>Rate Jurassic World: Rebirth (2025) on a scale of 1 to 5. Enter “NA” if you haven’t watched this movie</p></li>
<li><p>Rate Sinners (2025) on a scale of 1 to 5. Enter “NA” if you haven’t watched this movie</p></li>
<li><p>Rate Zootopia 2 (2025) on a scale of 1 to 5. Enter “NA” if you haven’t watched this movie</p></li>
</ul>
</section>
<section id="anticipated-data-challenges" class="level3">
<h3 class="anchored" data-anchor-id="anticipated-data-challenges">Anticipated Data Challenges</h3>
<p>One of the main challenges is to handle the missing data in this dataset. It has both categorical and numerical variables. Another challenge is to insert the data into a relational database from the survey response. Also, the column names in the survey response file are the questions asked in the survey, which need to replace with proper column names for easier data manipulation. The survey response can be viewed here: <a href="https://raw.githubusercontent.com/NafeesKhandker/Movie-Rating-Data/refs/heads/main/Movie%20Rating%20(Responses).csv" class="uri">https://raw.githubusercontent.com/NafeesKhandker/Movie-Rating-Data/refs/heads/main/Movie%20Rating%20(Responses).csv</a></p>
</section>
<section id="connecting-r-to-sql-database-postgresql" class="level3">
<h3 class="anchored" data-anchor-id="connecting-r-to-sql-database-postgresql">Connecting R to SQL Database (PostgreSQL)</h3>
<p>To connect R to PostgreSQL I am installing two libraries RPostgres and DBI.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("RPostgres")</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages("DBI")</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The host, port, dbname, user and password is set from pgAdmin4. Then I opened a database connection using the host, port, dbname, user and password. The R function dbReadTable() is reading the data from the table rating_final and storing the data to dataframe df. Finally, the connection is closed.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DBI)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RPostgres)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>host <span class="ot">&lt;-</span> <span class="st">"localhost"</span>       </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>port <span class="ot">&lt;-</span> <span class="dv">5432</span>          </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>dbname <span class="ot">&lt;-</span> <span class="st">"DATA607"</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>user <span class="ot">&lt;-</span> <span class="st">"postgres"</span>   </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>password <span class="ot">&lt;-</span> <span class="st">"data607"</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>conn <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  RPostgres<span class="sc">::</span><span class="fu">Postgres</span>(),</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">dbname =</span> dbname,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">host =</span> host,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">port =</span> port,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">user =</span> user,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">password =</span> password</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">dbReadTable</span>(conn, <span class="st">"rating_final"</span>)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="fu">dbDisconnect</span>(conn)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Using tidyverse, I am printing the dataframe using the glimpse() function.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.6
✔ forcats   1.0.1     ✔ stringr   1.6.0
✔ ggplot2   4.0.1     ✔ tibble    3.3.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.2
✔ purrr     1.2.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 7
Columns: 11
$ Email                                                 &lt;chr&gt; "feva0706@gmail.…
$ Name                                                  &lt;chr&gt; "Foizunnesa Eva"…
$ Age                                                   &lt;int&gt; 33, 23, 36, 32, …
$ Gender                                                &lt;chr&gt; "Female", "Male"…
$ Timestamp                                             &lt;chr&gt; "2/4/2026 20:12"…
$ Superman..2025..Rating                                &lt;chr&gt; "3.5", "4.5", NA…
$ F1..The.Movie..2025..Rating                           &lt;chr&gt; "4.2", "4", NA, …
$ Mission..Impossible.The.Final.Reckoning..2025..Rating &lt;chr&gt; "4.5", "4.1", "4…
$ Jurassic.World..Rebirth..2025..Rating                 &lt;chr&gt; "3", "3", "3.5",…
$ Sinners..2025..Rating                                 &lt;chr&gt; NA, NA, NA, "4.5…
$ Zootopia.2..2025..Rating                              &lt;chr&gt; NA, "4.3", NA, "…</code></pre>
</div>
</div>
<p>Using gt package, I am representing the dataframe in a structured table that helps to look into the data closely.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="qiwxldpbzq" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#qiwxldpbzq table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#qiwxldpbzq thead, #qiwxldpbzq tbody, #qiwxldpbzq tfoot, #qiwxldpbzq tr, #qiwxldpbzq td, #qiwxldpbzq th {
  border-style: none;
}

#qiwxldpbzq p {
  margin: 0;
  padding: 0;
}

#qiwxldpbzq .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#qiwxldpbzq .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#qiwxldpbzq .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#qiwxldpbzq .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#qiwxldpbzq .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qiwxldpbzq .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qiwxldpbzq .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#qiwxldpbzq .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#qiwxldpbzq .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#qiwxldpbzq .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#qiwxldpbzq .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#qiwxldpbzq .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#qiwxldpbzq .gt_spanner_row {
  border-bottom-style: hidden;
}

#qiwxldpbzq .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#qiwxldpbzq .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#qiwxldpbzq .gt_from_md > :first-child {
  margin-top: 0;
}

#qiwxldpbzq .gt_from_md > :last-child {
  margin-bottom: 0;
}

#qiwxldpbzq .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#qiwxldpbzq .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#qiwxldpbzq .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#qiwxldpbzq .gt_row_group_first td {
  border-top-width: 2px;
}

#qiwxldpbzq .gt_row_group_first th {
  border-top-width: 2px;
}

#qiwxldpbzq .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qiwxldpbzq .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#qiwxldpbzq .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#qiwxldpbzq .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qiwxldpbzq .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#qiwxldpbzq .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#qiwxldpbzq .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#qiwxldpbzq .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#qiwxldpbzq .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#qiwxldpbzq .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qiwxldpbzq .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qiwxldpbzq .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#qiwxldpbzq .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#qiwxldpbzq .gt_left {
  text-align: left;
}

#qiwxldpbzq .gt_center {
  text-align: center;
}

#qiwxldpbzq .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#qiwxldpbzq .gt_font_normal {
  font-weight: normal;
}

#qiwxldpbzq .gt_font_bold {
  font-weight: bold;
}

#qiwxldpbzq .gt_font_italic {
  font-style: italic;
}

#qiwxldpbzq .gt_super {
  font-size: 65%;
}

#qiwxldpbzq .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#qiwxldpbzq .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#qiwxldpbzq .gt_indent_1 {
  text-indent: 5px;
}

#qiwxldpbzq .gt_indent_2 {
  text-indent: 10px;
}

#qiwxldpbzq .gt_indent_3 {
  text-indent: 15px;
}

#qiwxldpbzq .gt_indent_4 {
  text-indent: 20px;
}

#qiwxldpbzq .gt_indent_5 {
  text-indent: 25px;
}

#qiwxldpbzq .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#qiwxldpbzq div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Email" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Email</th>
<th id="Name" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Name</th>
<th id="Age" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Age</th>
<th id="Gender" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Gender</th>
<th id="Timestamp" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Timestamp</th>
<th id="Superman..2025..Rating" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Superman..2025..Rating</th>
<th id="F1..The.Movie..2025..Rating" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">F1..The.Movie..2025..Rating</th>
<th id="Mission..Impossible.The.Final.Reckoning..2025..Rating" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Mission..Impossible.The.Final.Reckoning..2025..Rating</th>
<th id="Jurassic.World..Rebirth..2025..Rating" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Jurassic.World..Rebirth..2025..Rating</th>
<th id="Sinners..2025..Rating" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Sinners..2025..Rating</th>
<th id="Zootopia.2..2025..Rating" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Zootopia.2..2025..Rating</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Email">feva0706@gmail.com</td>
<td class="gt_row gt_left" headers="Name">Foizunnesa Eva</td>
<td class="gt_row gt_right" headers="Age">33</td>
<td class="gt_row gt_left" headers="Gender">Female</td>
<td class="gt_row gt_right" headers="Timestamp">2/4/2026 20:12</td>
<td class="gt_row gt_right" headers="Superman..2025..Rating">3.5</td>
<td class="gt_row gt_right" headers="F1..The.Movie..2025..Rating">4.2</td>
<td class="gt_row gt_right" headers="Mission..Impossible.The.Final.Reckoning..2025..Rating">4.5</td>
<td class="gt_row gt_right" headers="Jurassic.World..Rebirth..2025..Rating">3</td>
<td class="gt_row gt_right" headers="Sinners..2025..Rating">NA</td>
<td class="gt_row gt_right" headers="Zootopia.2..2025..Rating">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Email">jahidneel10@gmail.com</td>
<td class="gt_row gt_left" headers="Name">Jahid Hasan</td>
<td class="gt_row gt_right" headers="Age">23</td>
<td class="gt_row gt_left" headers="Gender">Male</td>
<td class="gt_row gt_right" headers="Timestamp">2/4/2026 21:37</td>
<td class="gt_row gt_right" headers="Superman..2025..Rating">4.5</td>
<td class="gt_row gt_right" headers="F1..The.Movie..2025..Rating">4</td>
<td class="gt_row gt_right" headers="Mission..Impossible.The.Final.Reckoning..2025..Rating">4.1</td>
<td class="gt_row gt_right" headers="Jurassic.World..Rebirth..2025..Rating">3</td>
<td class="gt_row gt_right" headers="Sinners..2025..Rating">NA</td>
<td class="gt_row gt_right" headers="Zootopia.2..2025..Rating">4.3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Email">mhasanww@gmail.com</td>
<td class="gt_row gt_left" headers="Name">Mahmudul Hasan</td>
<td class="gt_row gt_right" headers="Age">36</td>
<td class="gt_row gt_left" headers="Gender">Male</td>
<td class="gt_row gt_right" headers="Timestamp">2/5/2026 10:18</td>
<td class="gt_row gt_right" headers="Superman..2025..Rating">NA</td>
<td class="gt_row gt_right" headers="F1..The.Movie..2025..Rating">NA</td>
<td class="gt_row gt_right" headers="Mission..Impossible.The.Final.Reckoning..2025..Rating">4.8</td>
<td class="gt_row gt_right" headers="Jurassic.World..Rebirth..2025..Rating">3.5</td>
<td class="gt_row gt_right" headers="Sinners..2025..Rating">NA</td>
<td class="gt_row gt_right" headers="Zootopia.2..2025..Rating">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Email">sadmansobhan@yahoo.com</td>
<td class="gt_row gt_left" headers="Name">Sadman Sobhan</td>
<td class="gt_row gt_right" headers="Age">32</td>
<td class="gt_row gt_left" headers="Gender">Male</td>
<td class="gt_row gt_right" headers="Timestamp">2/5/2026 13:20</td>
<td class="gt_row gt_right" headers="Superman..2025..Rating">NA</td>
<td class="gt_row gt_right" headers="F1..The.Movie..2025..Rating">4.9</td>
<td class="gt_row gt_right" headers="Mission..Impossible.The.Final.Reckoning..2025..Rating">4</td>
<td class="gt_row gt_right" headers="Jurassic.World..Rebirth..2025..Rating">NA</td>
<td class="gt_row gt_right" headers="Sinners..2025..Rating">4.5</td>
<td class="gt_row gt_right" headers="Zootopia.2..2025..Rating">3.9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Email">shahjahan.cseku11@gmail.com</td>
<td class="gt_row gt_left" headers="Name">Shahjahan Shahed</td>
<td class="gt_row gt_right" headers="Age">40</td>
<td class="gt_row gt_left" headers="Gender">Male</td>
<td class="gt_row gt_right" headers="Timestamp">2/5/2026 16:01</td>
<td class="gt_row gt_right" headers="Superman..2025..Rating">3.6</td>
<td class="gt_row gt_right" headers="F1..The.Movie..2025..Rating">NA</td>
<td class="gt_row gt_right" headers="Mission..Impossible.The.Final.Reckoning..2025..Rating">4.8</td>
<td class="gt_row gt_right" headers="Jurassic.World..Rebirth..2025..Rating">NA</td>
<td class="gt_row gt_right" headers="Sinners..2025..Rating">4</td>
<td class="gt_row gt_right" headers="Zootopia.2..2025..Rating">NA</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Email">rhoque.nsu@gmail.com</td>
<td class="gt_row gt_left" headers="Name">Readwanul Hoque</td>
<td class="gt_row gt_right" headers="Age">49</td>
<td class="gt_row gt_left" headers="Gender">Male</td>
<td class="gt_row gt_right" headers="Timestamp">2/5/2026 20:30</td>
<td class="gt_row gt_right" headers="Superman..2025..Rating">NA</td>
<td class="gt_row gt_right" headers="F1..The.Movie..2025..Rating">3.5</td>
<td class="gt_row gt_right" headers="Mission..Impossible.The.Final.Reckoning..2025..Rating">3.7</td>
<td class="gt_row gt_right" headers="Jurassic.World..Rebirth..2025..Rating">NA</td>
<td class="gt_row gt_right" headers="Sinners..2025..Rating">4.1</td>
<td class="gt_row gt_right" headers="Zootopia.2..2025..Rating">NA</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Email">kayenath.sdc07@gmail.com</td>
<td class="gt_row gt_left" headers="Name">Tabassumul Kayenath</td>
<td class="gt_row gt_right" headers="Age">39</td>
<td class="gt_row gt_left" headers="Gender">Female</td>
<td class="gt_row gt_right" headers="Timestamp">2/5/2026 20:32</td>
<td class="gt_row gt_right" headers="Superman..2025..Rating">NA</td>
<td class="gt_row gt_right" headers="F1..The.Movie..2025..Rating">NA</td>
<td class="gt_row gt_right" headers="Mission..Impossible.The.Final.Reckoning..2025..Rating">NA</td>
<td class="gt_row gt_right" headers="Jurassic.World..Rebirth..2025..Rating">NA</td>
<td class="gt_row gt_right" headers="Sinners..2025..Rating">NA</td>
<td class="gt_row gt_right" headers="Zootopia.2..2025..Rating">4.6</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="subset-the-data-and-handle-missing-values" class="level3">
<h3 class="anchored" data-anchor-id="subset-the-data-and-handle-missing-values">Subset the Data and Handle Missing Values</h3>
<p>I am creating the subset of the dataframe with only the movie ratings. Since, the ratings are stored as text, I am explicitly converting it to numerical numbers. Finally, I am replacing the missing ratings (imputation) with mean. A head() printing of the dataframe confirms the change.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>rating_cols <span class="ot">&lt;-</span> <span class="fu">names</span>(df)[<span class="dv">6</span><span class="sc">:</span><span class="dv">11</span>]</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(rating_cols), as.numeric))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">all_of</span>(rating_cols), <span class="sc">~</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(.), <span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>), .)))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        Email             Name Age Gender      Timestamp
1          feva0706@gmail.com   Foizunnesa Eva  33 Female 2/4/2026 20:12
2       jahidneel10@gmail.com      Jahid Hasan  23   Male 2/4/2026 21:37
3          mhasanww@gmail.com   Mahmudul Hasan  36   Male 2/5/2026 10:18
4      sadmansobhan@yahoo.com    Sadman Sobhan  32   Male 2/5/2026 13:20
5 shahjahan.cseku11@gmail.com Shahjahan Shahed  40   Male 2/5/2026 16:01
6        rhoque.nsu@gmail.com  Readwanul Hoque  49   Male 2/5/2026 20:30
  Superman..2025..Rating F1..The.Movie..2025..Rating
1               3.500000                        4.20
2               4.500000                        4.00
3               3.866667                        4.15
4               3.866667                        4.90
5               3.600000                        4.15
6               3.866667                        3.50
  Mission..Impossible.The.Final.Reckoning..2025..Rating
1                                                   4.5
2                                                   4.1
3                                                   4.8
4                                                   4.0
5                                                   4.8
6                                                   3.7
  Jurassic.World..Rebirth..2025..Rating Sinners..2025..Rating
1                              3.000000                   4.2
2                              3.000000                   4.2
3                              3.500000                   4.2
4                              3.166667                   4.5
5                              3.166667                   4.0
6                              3.166667                   4.1
  Zootopia.2..2025..Rating
1                 4.266667
2                 4.300000
3                 4.266667
4                 3.900000
5                 4.266667
6                 4.266667</code></pre>
</div>
</div>
</section>
<section id="visualize-the-average-movie-rating" class="level3">
<h3 class="anchored" data-anchor-id="visualize-the-average-movie-rating">Visualize the Average Movie Rating</h3>
<p>I am reshaping the data to long format so that it can be properly used by gglot2. Then, I am calculating the average of each movie’s rating and plotting a horizontal bar chart. Finally, adding title, labels, assigning colors and annotation for better visualization.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reshape data to long format</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">all_of</span>(rating_cols),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Movie"</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Rating"</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Movie =</span> <span class="fu">str_replace_all</span>(Movie, <span class="st">"</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">.2025</span><span class="sc">\\</span><span class="st">.</span><span class="sc">\\</span><span class="st">.Rating"</span>, <span class="st">""</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Movie =</span> <span class="fu">str_replace_all</span>(Movie, <span class="st">"</span><span class="sc">\\</span><span class="st">."</span>, <span class="st">" "</span>))</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average ratings per movie</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>avg_ratings <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Movie) <span class="sc">%&gt;%</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Average_Rating =</span> <span class="fu">mean</span>(Rating, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot horizontal bar chart with different colors and annotation</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(avg_ratings, <span class="fu">aes</span>(<span class="at">x =</span> Average_Rating, <span class="at">y =</span> <span class="fu">fct_reorder</span>(Movie, Average_Rating), <span class="at">fill =</span> Movie)) <span class="sc">+</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Average_Rating, <span class="dv">2</span>)), </span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="co"># position outside the bar</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">"Set3"</span>) <span class="sc">+</span> <span class="co"># nice color palette</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average Ratings of Movies"</span>,</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Average Rating"</span>,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Movie"</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span> <span class="co"># remove legend as colors already indicate movies</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="fu">max</span>(avg_ratings<span class="sc">$</span>Average_Rating) <span class="sc">+</span> <span class="dv">1</span>) <span class="co"># adjust x-axis for labels</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assignment-2A_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>The bar chart shows that according to the participants, the Mission Impossible: The Final Reckoning is the highest rated movie. Zootopia 2, Sinners, F1: The movie got almost identical average rating (~4.2). The Jurassic World Rebirth has the lowest average rating of 3.17. More insights can be found if we can find correlation between the participant’s demographic information with the rating. A movie recommender system can be created as well based on the age, sex, etc. of the participants.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>